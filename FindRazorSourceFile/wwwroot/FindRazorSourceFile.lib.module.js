"use strict";const E={openInVSCode:!1},H="razorsource:options",x="NotFound",y="none",a=null,T="./_content/FindRazorSourceFile/",L="findrazorsourcefile-ui",h=document,M=Node.COMMENT_NODE,B=Node.ELEMENT_NODE,P={top:Number.MAX_SAFE_INTEGER,left:Number.MAX_SAFE_INTEGER,bottom:Number.MIN_SAFE_INTEGER,right:Number.MIN_SAFE_INTEGER};let U=!1,k=a,w=a,c,b=a,W=[],g=a,K=[],m=a;const V={};let u=0;const R=e=>Array.isArray(e),I=e=>e.reduce((t,o)=>({top:Math.min(t.top,o.top),left:Math.min(t.left,o.left),bottom:Math.max(t.bottom,o.bottom),right:Math.max(t.right,o.right)}),P),D=(e,t)=>t!==null&&t.left<e.clientX&&e.clientX<t.right&&t.top<e.clientY&&e.clientY<t.bottom,$=e=>{let t=0;for(;e;)t++,e=e.parentElement;return t},S=(e,t)=>{for(let o in t)e.addEventListener(o,t[o])},F=(e,t)=>{for(let o in t)e.removeEventListener(o,t[o])},N=e=>e.stopPropagation(),O=(e,t)=>Object.assign(e.style,t),f=(e,t,o,i)=>{let n={};const s=h.createElement(e);t&&O(s,t),o&&Object.assign(s,o);const p=([r,l])=>(s.appendChild(r),n={...n,...l},r);return i?.forEach(r=>{if(R(r))p(r);else for(let l in r){const v=p(r[l]);n[l]=v}}),[s,n]};export function afterWebStarted(){init()}export function afterStarted(){init()}export const init=()=>{if(U)return;U=!0,se(),customElements.define(L,re);const e=()=>{if(document.body.querySelector(L))return;const[t]=f(L);h.body.appendChild(t)};Blazor.addEventListener("enhancedload",e),e(),S(h,{keydown:ae}),S(window,{resize:oe,scroll:oe,storage:ue})};const ie=async()=>{const e=i=>i.textContent?.trim().match(/^(begin|end):(frsf-[a-z0-9]{10})$/)||[],t=[],o=h.createTreeWalker(h.body,NodeFilter.SHOW_COMMENT,a);for(;o.nextNode();){const i=o.currentNode,[,n,s]=e(i);if(n!=="begin")continue;const p=await z(s);if(!p||p===x)continue;let r=i.nextSibling;const l=[];for(;r;){if(r.nodeType===B&&l.push(r),r.nodeType===M){const[,v,d]=e(r);if(v==="end"&&d===s&&l.length>0){t.push({hash:s,rect:()=>I(l.map(C=>C.getBoundingClientRect())),depth:Math.min(...l.map($)),source:p,elements:l});break}}r=r.nextSibling}}return t},se=()=>{const e=h.createTreeWalker(h.body,NodeFilter.SHOW_COMMENT,a);for(;e.nextNode();){const t=e.currentNode;if(t.textContent!=="!")continue;if(Object.getOwnPropertySymbols(t).forEach(i=>{const n=t[i];n&&(R(n)?w=w||i:typeof n.nodeType!==void 0&&(k=k||i))}),k&&w)break}};class re extends HTMLElement{constructor(){super()}connectedCallback(){const t=this.attachShadow({mode:"open"}),o=ce(t);c=o,_(1),S(o.overlay,{mousemove:X,click:j}),S(o.sourceNameTip,{mousemove:N,click:Y}),S(o.settingsButton,{click:J}),S(o.settingsForm,{click:N}),S(o.settingsOpenInVSCode,{click:q}),ne(),this.dispose=()=>{F(o.overlay,{mousemove:X,click:j}),F(o.sourceNameTip,{mousemove:N,click:Y}),F(o.settingsButton,{click:J}),F(o.settingsForm,{click:N}),F(o.settingsOpenInVSCode,{click:q})}}disconnectedCallback(){this.dispose?.()}}const ce=e=>{const[t,o]=f("div",{position:"fixed",top:"0",left:"0",bottom:"0",right:"0",zIndex:"9999",backgroundColor:"transparent",borderStyle:"solid",display:y,opacity:"0",transition:"border 0.2s ease-out, box-shadow 0.2s ease-out, opacity 0.2s linear"},a,[{sourceNameTip:f("div",{position:"absolute",top:"4px",left:"4px",padding:"2px 6px",fontFamily:"sans-serif",fontSize:"12px",color:"#111",backgroundColor:"#ffc107",boxShadow:"2px 2px 4px 0px rgb(0, 0, 0, 0.5)",whiteSpace:"nowrap",display:y,transition:"opacity 0.2s ease-out",pointerEvents:y},a,[f("img",{verticalAlign:"middle",width:"16px"},{src:T+"ASPWebApplication_16x.svg"}),{sourceNameTipProjectName:f("span",{verticalAlign:"middle",marginLeft:"4px"})},f("span",{verticalAlign:"middle"},{textContent:" | "}),f("img",{verticalAlign:"middle",width:"16px"},{src:T+"ASPRazorFile_16x.svg"}),{sourceNameTipItemName:f("span",{verticalAlign:"middle",marginLeft:"4px"})}])},{settingsButton:f("button",{position:"fixed",bottom:"8px",right:"8px",height:"32px",paddingLeft:"30px",fontFamily:"sans-serif",fontSize:"12px",color:"#111",border:y,backgroundColor:"#fff",borderRadius:"64px",outline:y,backgroundImage:`url('${T}settings_black_24dp.svg')`,backgroundRepeat:"no-repeat",backgroundPosition:"5px center"},{title:"Find Razor Source File - Settings",textContent:"Find Razor Source File"})},{settingsForm:f("div",{position:"fixed",bottom:"0",right:"8px",padding:"8px 12px",border:"#ccc",backgroundColor:"#fff",borderRadius:"8px",boxShadow:"2px 2px 4px 0px rgb(0, 0, 0, 0.5)",opacity:"0",transition:"ease-out all 0.2s",pointerEvents:y},a,[f("label",{margin:"0",padding:"0",fontFamily:"sans-serif",fontSize:"12px",color:"#111"},a,[{settingsOpenInVSCode:f("input",{margin:"0 8px 0 0",padding:"0",verticalAlign:"middle"},{type:"checkbox"})},f("span",{verticalAlign:"middle"},{textContent:"Open the .razor file of the clicked component in "}),f("img",{verticalAlign:"middle",width:"18px"},{src:T+"vscode.svg"}),f("span",{verticalAlign:"middle"},{textContent:" VSCode"})])])}]);return e.appendChild(t),{overlay:t,...o}},_=e=>{const t=e===1?.3:.5,o=e===1?"0.8":"1.0";O(c.overlay,{borderColor:`rgba(0, 0, 0, ${t})`,boxShadow:`inset rgb(0, 0, 0, ${t}) 0px 0px 6px 4px`}),O(c.sourceNameTip,{opacity:o,pointerEvents:e===2?"auto":"none"})},G=(e,t)=>{c.sourceNameTipProjectName.textContent=e,c.sourceNameTipItemName.textContent=t},ae=async e=>{const t=e.code==="KeyF"&&e.ctrlKey&&e.shiftKey&&!e.metaKey&&!e.altKey,o=e.code==="Escape"&&!e.ctrlKey&&!e.shiftKey&&!e.metaKey&&!e.altKey;u===0&&t?(N(e),e.preventDefault(),W=await ie(),u=1,O(c.overlay,{borderWidth:"50vh 50vw",display:"block"}),A(),setTimeout(()=>{(u===1||u===2)&&(c.overlay.style.opacity="1")},1),G("",""),g=a,K=[],m=a):(u===1||u===2)&&(o||t)&&(N(e),e.preventDefault(),u=t?0:u===2?1:0,_(1),c.sourceNameTip.style.display=y,c.overlay.style.borderWidth="50vh 50vw",A(),u===0&&(W=[],c.overlay.style.opacity="0",setTimeout(()=>{u===0&&(c.overlay.style.display=y)},200)))},X=async e=>{u===1&&Z(e)},j=e=>{if(A(),u===1){if(g&&b&&b!==x){u=2,_(2);const t=new Event("razorsource:lockin",{bubbles:!1,cancelable:!1});t.razorSourceName=b,h.dispatchEvent(t),E.openInVSCode&&(window.location.href=`vscode://file/${b.fullPath}`)}}else u===2&&(u=1,_(1),Z(e))},Y=e=>{N(e),u===1&&j(e)},J=e=>{N(e),pe()?le():A()},le=()=>Object.assign(c.settingsForm.style,{opacity:"1",bottom:"48px",pointerEvents:"unset"}),A=()=>Object.assign(c.settingsForm.style,{opacity:"0",bottom:"0",pointerEvents:y}),pe=()=>c.settingsForm.style.opacity==="0",q=e=>{N(e),E.openInVSCode=c.settingsOpenInVSCode.checked,me()},Z=async e=>{const t=await de(e);t.scopeHasChanged!==!1&&(b=await z(t),ee(t.scopeRect,b))},de=async e=>{const t=c.sourceNameTip.style.visibility;c.sourceNameTip.style.visibility="hidden",c.overlay.style.visibility="hidden";const o=h.elementFromPoint(e.clientX,e.clientY);c.overlay.style.visibility="visible",c.sourceNameTip.style.visibility=t;let i=a,n=a,s=a,p=[],r=a;for(let d=o;d;d=d.parentElement)i?i===await Q(d)&&(r=d):(i=await Q(d),i&&(r=d));i&&r&&(p=[r],n=(g===i?m:a)||te(r),s=await z(i));const l=W.filter(d=>D(e,d.rect())).sort((d,C)=>C.depth!==d.depth?C.depth-d.depth:d.elements.length-C.elements.length)[0];if(l){let d=!1;i?r&&s&&(s!==x&&s.itemName===l.source.itemName?(n=I([n||P,l.rect()]),p=[r,...l.elements]):$(r)<l.depth&&(d=!0)):d=!0,d&&(i=l.hash,p=l.elements,n=l.rect(),s=l.source)}if(!i||!n){if(D(e,m))return{scope:g,scopeRect:m,scopeHasChanged:!1}}else if(g&&g!==i&&m&&D(e,m)&&n.left<m.left&&n.right>m.right&&n.top<m.top&&n.bottom>m.bottom)return{scope:g,scopeRect:m,scopeHasChanged:!1};const v=g!==i;return v&&(g=i,K=p,m=n),{scope:g,scopeRect:m,scopeHasChanged:v,source:s}},Q=async e=>{const t=e.getAttributeNames().filter(i=>i.startsWith("b-"))[0]||a,o=await z(t);return!o||o===x?a:t},z=async e=>{if(e&&typeof e!="string"&&e.source)return e.source;const t=typeof e=="string"?e:e?.scope||a;if(!t)return a;let o=V[t]||a;if(o)return o;const i=await fetch(`${T}RazorSourceMapFiles/${t}.txt`);if(i.ok){const s=(await i.text()).replace(/[\r\n]*$/ig,"").split("|"),p={projectName:s[0],itemName:s[1],fullPath:s[2]};return V[t]=p,p}else return V[t]=x,x},ee=(e,t)=>{if(!e||!t||t===x){c.sourceNameTip.style.display=y,c.overlay.style.borderWidth="50vh 50vw";return}const o=c.overlay.getBoundingClientRect(),i=o.height-e.bottom,n=o.width-e.right;O(c.overlay,{borderStyle:"solid",borderTopWidth:e.top>0?e.top+"px":0,borderLeftWidth:e.left>0?e.left+"px":0,borderBottomWidth:i>0?i+"px":0,borderRightWidth:n>0?n+"px":0}),G(t.projectName,t.itemName),c.sourceNameTip.style.display="block"},te=e=>{const t=n=>{const s=[a,[]];if(!k||!w)return s;const p=n[k],r=n[w];return R(p)||!p||!R(r)||!r?s:[p,r]},o=n=>{const[s,p]=t(n);if(s?.nodeType===M){const[r,l]=t(s);return[...l,n]}else if(n.nodeType===M)return[...p,n];return[n]},i=n=>I(n.map(s=>s.nodeType===B?s.getBoundingClientRect():s.nodeType===M?i(t(s)[1]):P));return i(o(e))},oe=e=>{u!==0&&(!g||!m||!b||b===x||(m=I(K.map(t=>te(t))),ee(m,b)))},ue=e=>ne(),me=()=>{const e=JSON.stringify(E);localStorage.setItem(H,e)},ne=()=>{const e=localStorage.getItem(H);Object.assign(E,JSON.parse(e||"{}")),c.settingsOpenInVSCode.checked=E.openInVSCode};
